import{s as h,n as v,g as f}from"./index.404bbd5c.js";import{h as u}from"./clipboard.e9c1329a.js";function _(t){return h({url:"/api/images",method:"post",data:t})}function b(t){return h({url:"/api/uploadfile",method:"post",data:t,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}})}var y="/assets/none.5fea8814.png",C=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"wrap"},[e("div",{staticClass:"top_btns"},[e("el-button",{attrs:{type:"primary"},on:{click:t.showAddBox}},[t._v("\u6DFB\u52A0\u56FE\u7247")])],1),t.tableData.length?e("el-row",t._l(t.tableData,function(s,n){return e("el-col",{key:s.id,attrs:{span:5}},[e("el-card",{staticClass:"carder"},[e("el-image",{staticClass:"image",attrs:{src:t.getAssetsFile(s.smallPath)}},[e("div",{attrs:{slot:"placeholder"},slot:"placeholder"},[t._v(" \u52A0\u8F7D\u4E2D"),e("span",{staticClass:"dot"},[t._v("...")])])]),e("div",{staticClass:"bottom"},[e("time",{staticClass:"time"},[t._v(t._s(t._f("formatTime")(s.createdAt,"{y}-{m}-{d} {h}:{i}:{s}")))]),e("div",{staticClass:"btns"},[e("el-button",{staticClass:"button",attrs:{size:"mini",type:"primary"},on:{click:function(l){t.copy(l,t.getAssetsFile(s.path))}}},[t._v("\u590D\u5236\u5730\u5740")]),e("el-button",{staticClass:"button",attrs:{size:"mini",type:"success"},on:{click:function(l){t.openWindow(t.getAssetsFile(s.path))}}},[t._v("\u67E5\u770B\u539F\u56FE")])],1)])],1)],1)}),1):e("el-row",[e("el-col",{staticClass:"col_none_box",attrs:{span:24}},[e("el-image",{staticClass:"none_img",attrs:{src:t.noneImg}}),e("span",{staticClass:"none_text"},[t._v("\u6682\u65F6\u6CA1\u6709\u6570\u636E")])],1)],1),e("el-pagination",{attrs:{"current-page":t.pageNumber,"page-sizes":[20,40,60,80,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),e("el-dialog",{attrs:{title:"\u6DFB\u52A0\u56FE\u7247",visible:t.dialogFormVisible},on:{"update:visible":function(s){t.dialogFormVisible=s}}},[e("form",{attrs:{method:"post"}},[e("input",{attrs:{type:"hidden",name:"base64",id:"dataFile"}}),e("div",{staticClass:"btn_wrap"},[e("a",{staticClass:"btn_a",attrs:{href:"javascript:;"}}),e("input",{attrs:{type:"file",name:"file",id:"file"},on:{change:t.changeImg}})])]),e("div",{staticClass:"box"},[e("img",{staticClass:"photo photo-img"})]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(s){t.dialogFormVisible=!1}}},[t._v("\u53D6 \u6D88")]),e("el-button",{attrs:{type:"primary"},on:{click:t.upFunc}},[t._v("\u786E \u5B9A")])],1)])],1)},w=[];const F={name:"Home",data(){return{noneImg:y,tableData:[],pageSize:20,pageNumber:1,total:0,file:null,dialogFormVisible:!1}},mounted(){this.getList()},methods:{getAssetsFile:f,handleClipboard:u,async getList(){let{pageSize:t,pageNumber:a}=this,s=await _({pageSize:t,pageNumber:a});s&&(this.total=s.count,this.tableData=s.rows)},handleSizeChange(t){this.pageSize=t,this.getList()},handleCurrentChange(t){this.pageNumber=t,this.getList()},showAddBox(){this.dialogFormVisible=!0},changeImg(){var t=document.querySelector("#file").files[0];this.file=t;var a=t.type,e=new FileReader;e.onload=function(s){var n=s.target.result,l=new Image;l.src=n,l.onload=function(){var i=document.createElement("canvas"),c=1,o=200;c=o/this.width,this.width>o?(i.width=o,i.height=this.height*c):(i.width=this.width,i.height=this.height);var m=i.getContext("2d");m.drawImage(this,0,0,i.width,i.height);var d=i.toDataURL(a,.8),r="";a=="image/gif"?r=d.replace("data:image/png;base64,",""):r=d.replace("data:"+a+";base64,",""),document.querySelector("#dataFile").value=r};var g=document.querySelector(".photo-img");g.setAttribute("src",n),document.querySelector(".box").style.display="block"},e.readAsDataURL(t)},async upFunc(){this.dialogFormVisible=!1;let t=document.querySelector("#dataFile").value,a=new FormData;a.append("file",this.file),a.append("base64",t),await b(a)},copy(t,a){u(a,t)},openWindow(t){window.open(t)}}},p={};var x=v(F,C,w,!1,z,"b9dffb12",null,null);function z(t){for(let a in p)this[a]=p[a]}var A=function(){return x.exports}();export{A as default};
